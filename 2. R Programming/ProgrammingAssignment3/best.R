hosp_sort <- function(state,outcome){
       #setting NA to be 0
       rates[rates == "Not Available"] <- 0
       index <- c(grep("^Hospital.*Death*", names(rates)))
       mortality_rates <- rates[,c(2,7,index)]
       names(mortality_rates)[3:5] <- c("heart attack", "heart failure", "pneumonia")
       
       #Making rates numeric
       mortality_rates[,3:5] <- apply(mortality_rates[,3:5],2,as.numeric)
       
       mortality_rates[mortality_rates == 0] <- NA
       selected_state <- mortality_rates[mortality_rates$State == state,]
       
       order_selected <- arrange(selected_state, selected_state[,outcome], Hospital.Name, na.last=TRUE)
       order_selected <- order_selected[complete.cases(order_selected[,outcome]),]
       return(order_selected)
        #na.omit(selected_state[order(c(selected_state[,outcome]), na.last = TRUE),])
}

best <- function(state, outcome, st = "a") {
       if (!state %in% unique(rates$State))
              return("Invalid State")
       if (!outcome %in% c("heart attack", "heart failure", "pneumonia"))
              return("Invalid Outcome")
       
       order_selected <- hosp_sort(state,outcome)
       return(order_selected[1,1])

}
